<header class="page-header row">
    <h1 class="pull-left">Tag Items</h1>

    <!-- Export Tags stuff -->
    <div class="text-right" style="margin-top: 20px;">
        <button class="btn btn-default" disabled>
            <i class="glyphicon glyphicon-filter"></i> Filter by <span class="caret"></span>
        </button>
        <button class="btn btn-default" disabled>
            <i class="glyphicon glyphicon-sort-by-attributes"></i> Order by <span class="caret"></span>
        </button>
        <button class="btn btn-default" disabled>
            <i class="glyphicon glyphicon-th-list"></i> Group by <span class="caret"></span>
        </button>
        <button class="btn btn-default" disabled>
            <i class="glyphicon glyphicon-tags"></i> Tag Settings</span>
        </button>
        <button class="btn btn-info" data-toggle="modal" data-target="#export-modal">
            <i class="glyphicon glyphicon-save"></i> Export Tags
        </button>
    </div>
    <div class="modal fade" id="export-modal" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="exportModalLabel">Export Tags</h4>
          </div>
          <div class="modal-body">
            <form class="form-horizontal" role="form">
              <div class="form-group">
                <label for="export-attrs" class="col-sm-2 control-label">Attributes to export</label>
                <div class="col-sm-10">
                  <ul class="list-inline">
                    <li ng-repeat="(attrName, attrSchema) in itemSchema">
                      <span class="checkbox">
                        <label>
                          <input type="checkbox" ng-model="attrSchema.export">
                          {{attrName}}
                        </label>
                      </span>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="form-group">
                <label for="export-format" class="col-sm-2 control-label">Format</label>
                <div class="col-sm-10">
                  <select id="export-format" class="form-control" ng-model="exportFormat">
                    <option>sql</option>
                    <option>json</option>
                    <option>tsv</option>
                    <option>csv</option>
                  </select>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" ng-click="export(exportFormat)">Download</button>
          </div>
        </div>
      </div>
    </div>
</header>

<section class="row">

<div class="panel panel-default" ng-repeat="item in items"
  ng-class="$index == cursorIndex ? 'panel-primary' : 'panel-default'"
  ng-click="moveCursorTo($index)">
    <div class="panel-body">
        <!-- custom item rendering -->
        <span mb-render-item></span>
    </div>
    <div class="panel-footer" ng-controller="TagrTagsCtrl">
        <!-- custom tagging UI elements -->
        <span mb-render-tags></span>

        <!-- free form tags -->
        <span ng-repeat="(tagName, tagSchema) in tagsSchema" ng-if="!tagSchema.hidden">
            <!-- binary -->
            <label ng-if="tagSchema.type == 'binary'"
                btn-checkbox btn-checkbox-true="true" btn-checkbox-false="null"
                ng-model="tag[tagName]" ng-click="commit(tag)"
                ng-class="tag[tagName] ? 'btn-info' : 'btn-default'"
                class="btn"><i class="glyphicon glyphicon-tag"></i>
                <span class="tag-name">{{tagName}}</span>
            </label>
            <!-- TODO render categorical tags with one input box (name) and a dropdown -->
            <!-- TODO render freetext tags with two input boxes: name and value -->
            <!-- TODO autocomplete/typeahead in input boxes -->
        </span>

        <div class="btn-group">
            <!-- TODO support entering new binary tags -->
            <!-- TODO support entering new freetext and categorical tags -->
            <button class="btn btn-default"><i class="glyphicon glyphicon-plus"></i> <span class="caret"></span></button>
        </div>
    </div>
</div>

<!--
# TODOs

* Data model for tags
    * Fixed/enum (Binary, Multinomial) and Free-text/value tags
        * or Non-parameterized (binary) vs. Parameterized tags (the rest)
    * Repeatability of each tag: singleton? zero or more? up to N?
    * Side note: Different UI elements necessary for each category of tags
        * binary tags: checkbox/toggle button
        * multinomial tags: dropdown select or toggle button, with a way to manage the their value sets
        * Free-text/value tags: text or number input entry

* Minimal end-to-end features for workflows
    * Precision debugging workflow
        * correct/incorrect/undecidable buttons for each item
        * note input field, which will be superseded by free-text tags
    * Recall labeling workflow
        * add array of texts to each item
        * note input field, which will be superseded by free-text tags
    * Persistent state maintained in the extra annotation file (output)

* Arbitrary tags support
    * to each item
    * defining a new tag
    * entering a new value for a tag
    * selecting a previously entered tag
    * autocompletion of tag names as well as tag values
    * removing tag
    * filtering/clustering items by tag while tagging
        * e.g., "only show items that have no correct or incorrect tag"
        * "group items by a tag"
        * "show a histogram of selected tags"
        * "show a histogram of values of a tag"

* Custom renderers/controls
    * item controls
        * highlighting substrings in one column based on other columns
            * e.g., extracted entity candidates with the sentence
        * sentence with NLP tags as text that responds to interaction
    * tag controls
        * a way to specify a set of predefined tags
        * ok, question-sign, remove buttons for precision labeling

* Other goodies
    * Rich export feature
        * TSV generation
            * JSON for array fields
        * SQL generation (CREATE TABLE, INSERT INTO) with choice of schema
            * nested, array of tag values: (id, tag1[], tag2[], ...)
            * unnested flattened table:    (id, tag1, tag2, ...)

    * Keyboard shortcut support
        * navigation: prev/next item
        * easy tag toggling/addition/removal

    * Support array-typed items
        * Sentence with NLP tags (POS, NER, ...) is often represented as a tuple of arrays with same length
        * Other array columns in the input often contain aux info corresponding to each

    * Selecting a piece of text to use as a tag, or as a tag's value
        * mainly for recall ground truth labeling, to free user from copy/pasting all text

* See also
    * [GUIDELINES FOR DESIGNING USER INTERFACE SOFTWARE (ESD-TR-86-278)](http://hcibib.org/sam/1.html)

-->

</section>
